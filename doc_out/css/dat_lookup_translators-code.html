<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.6.1 on Thu Aug 18 11:37:50 2016 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>dat_lookup_translators.pro (OMINAS API Documentation)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="dat_lookup_translators.pro (OMINAS API Documentation)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;=============================================================================</span>
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	dat_lookup_translators</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Looks up the names of the data input and output tranlators in</span>
<span class="comments">;	the translators table.</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">;	NV/SYS</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	dat_lookup_translators, instrument, input_translators, output_translators</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; ARGUMENTS:</span>
<span class="comments">;  INPUT:</span>
<span class="comments">;	instrument:	Instrument string from dat_detect_instrument.</span>
<span class="comments">;</span>
<span class="comments">;  OUTPUT:</span>
<span class="comments">;	input_translators:	Array giving the names of the input translator </span>
<span class="comments">;				functions.</span>
<span class="comments">;</span>
<span class="comments">;	output_translators:	Array giving the names of the output translator </span>
<span class="comments">;				functions.</span>
<span class="comments">;</span>
<span class="comments">;	input_keyvals:	Array giving the keyword/value pairs the from the </span>
<span class="comments">;			translators table, for each input translator.</span>
<span class="comments">;</span>
<span class="comments">;	output_keyvals:	Array giving the keyword/value pairs the from the </span>
<span class="comments">;			translators table, for each output translator.</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; KEYWORDS:</span>
<span class="comments">;  INPUT: </span>
<span class="comments">;	silent:	If set, messages are suppressed.</span>
<span class="comments">;</span>
<span class="comments">;  OUTPUT: NONE</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; RETURN: NONE</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; STATUS:</span>
<span class="comments">;	Complete</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">; 	Written by:	Spitale</span>
<span class="comments">;	</span>
<span class="comments">;-</span>
<span class="comments">;=============================================================================</span>
<a id="dat_lookup_translators:source"></a>pro dat_lookup_translators, instrument, $
       input_translators, output_translators, input_keyvals, output_keyvals, $
        tab_translators=tab_translators, silent=silent
@nv_block.common
@core.include


 marker='-'
 input_translators = ''
 output_translators = ''

 <span class="comments">;=====================================================</span>
 <span class="comments">; read the translators table if it doesn't exist</span>
 <span class="comments">;=====================================================</span>
 if(NOT keyword_set(*nv_state.tr_table_p)) then $
   dat_read_config, 'NV_TRANSLATORS', $
              nv_state.tr_table_p, nv_state.translators_filenames_p
 table = *nv_state.tr_table_p
 if(NOT keyword_set(table)) then return


 <span class="comments">;==============================================================</span>
 <span class="comments">; lookup the instrument string</span>
 <span class="comments">;==============================================================</span>
 input_translator = ''
 output_translator = ''

 instruments = table[*,0]
 w0 = (where(instruments EQ instrument))[0]

 <span class="comments">;-----------------------------------------</span>
 <span class="comments">; if instrument not found, try DEFAULT</span>
 <span class="comments">;-----------------------------------------</span>
 if(w0[0] EQ -1) then $
     w0 = (where(instruments EQ 'DEFAULT'))[0]


 <span class="comments">;================================================================</span>
 <span class="comments">; extract all given translators and keyvals for this instrument</span>
 <span class="comments">;================================================================</span>
 if(w0 NE -1) then $
  begin
   w1 = w0
   wn = where(instruments[w0:*] NE marker)
   wc = where(instruments[w0:*] EQ marker)
   if(wc[0] NE -1) then $
    begin
<span class="comments">;     if(wn[0] EQ -1) then w1 = w0 + n_elements(wc) $</span>
<span class="comments">;     else w1 = w0 + wn[1]-1</span>
     if(n_elements(wn) GT 1) then w1 = w0 + wn[1]-1 $
     else w1 = w0 + n_elements(wc)
    end

   input_translators = table[w0:w1,1]
   output_translators = table[w0:w1,2]

   s = size(table)
   nfields = s[2]
   if(nfields GT 3) then keyvals = table[w0:w1,3:nfields-1]

  end $
 else return
 

 <span class="comments">;================================</span>
 <span class="comments">; filter out any place markers</span>
 <span class="comments">;================================</span>
 w = where(input_translators NE marker)
 if(w[0] EQ -1) then input_translators = '' $
 else $
  begin
   input_translators = input_translators[w]
   if(keyword_set(keyvals)) then input_keyvals = strtrim(keyvals[w,*],2)
  end

 w = where(output_translators NE marker)
 if(w[0] EQ -1) then output_translators = '' $
 else $
  begin
   output_translators = output_translators[w]
   if(keyword_set(keyvals)) then output_keyvals = strtrim(keyvals[w,*],2)
  end


end
<span class="comments">;===========================================================================</span>
</code>
    </div>
  </body>
</html>