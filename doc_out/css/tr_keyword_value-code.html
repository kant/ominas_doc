<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.6.1 on Thu Aug 18 11:37:53 2016 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>tr_keyword_value.pro (OMINAS API Documentation)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="tr_keyword_value.pro (OMINAS API Documentation)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;=============================================================================</span>
<span class="comments">;+</span>
<span class="comments">; NAME:</span>
<span class="comments">;	tr_keyword_value</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; PURPOSE:</span>
<span class="comments">;	Looks up a keyword in the data descriptor stored keyword/value pairs.</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; CATEGORY:</span>
<span class="comments">;	NV/SYS</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; CALLING SEQUENCE:</span>
<span class="comments">;	value = tr_keyword_value(dd, keyword)</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; ARGUMENTS:</span>
<span class="comments">;  INPUT:</span>
<span class="comments">;	dd:		Data descriptor.  If an array, only the first element is </span>
<span class="comments">;			considered.</span>
<span class="comments">;</span>
<span class="comments">;	keyword:	Keyword to look up.</span>
<span class="comments">;</span>
<span class="comments">;  OUTPUT: NONE</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; KEYWORDS:</span>
<span class="comments">;  INPUT: NONE</span>
<span class="comments">;</span>
<span class="comments">;  OUTPUT: NONE</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; RETURN: </span>
<span class="comments">;	Value string associated with the given keyword.  Note that transient</span>
<span class="comments">;	keyword/value pairs take precedence.</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; STATUS:</span>
<span class="comments">;	Complete</span>
<span class="comments">;</span>
<span class="comments">;</span>
<span class="comments">; MODIFICATION HISTORY:</span>
<span class="comments">; 	Written by:	Spitale</span>
<span class="comments">; 	Adapted by:	Spitale, 5/2016</span>
<span class="comments">;	</span>
<span class="comments">;-</span>
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; trkv_match</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="trkv_match:source"></a>pro trkv_match, kv, i, keyword, value=value

 if(NOT ptr_valid((*kv.keywords_p)[i])) then return
 if(NOT ptr_valid((*kv.values_p)[i])) then return

 keywords = (*(*kv.keywords_p)[i])
 values = (*(*kv.values_p)[i])

 w = where(keywords EQ keyword)

 if(w[0] EQ -1) then return

 value = values(w[0])
end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; trkv_parse</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="trkv_parse:source"></a>function trkv_parse, value

 <span class="comments">;---------------------------</span>
 <span class="comments">; arrays delimited by ';'</span>
 <span class="comments">;---------------------------</span>
 value = str_nsplit(value, ';')
 if(n_elements(value) EQ 1) then value = value[0]

 return, value
end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; tr_keyword_value</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="tr_keyword_value:source"></a>function tr_keyword_value, dd, keyword
@core.include

 _dd = cor_dereference(dd[0])

 <span class="comments">;----------------------------------------------------------------------</span>
 <span class="comments">; first look for transient keyval match</span>
 <span class="comments">;----------------------------------------------------------------------</span>
 if(ptr_valid(_dd.transient_keyvals_p)) then $
                trkv_match, *_dd.transient_keyvals_p, 0, keyword, value=value
 if(n_elements(value) NE 0) then return, trkv_parse(value)


 <span class="comments">;----------------------------------------------------------------------</span>
 <span class="comments">; if no transient keyval match, then match regular keyvals</span>
 <span class="comments">;----------------------------------------------------------------------</span>
 if(NOT ptr_valid(_dd.input_keyvals_p)) then return, ''

 <span class="comments">;----------------------------------------</span>
 <span class="comments">; determine input or output translator</span>
 <span class="comments">;----------------------------------------</span>
 i = _dd.last_translator[0]
 io = _dd.last_translator[1]

 if(io EQ 0) then kv = *_dd.input_keyvals_p $
 else kv = *_dd.output_keyvals_p

 <span class="comments">;-----------------</span>
 <span class="comments">; match keyval </span>
 <span class="comments">;-----------------</span>
 trkv_match, kv, i, keyword, value=value
 if(NOT keyword_set(value)) then value = ''


 return, trkv_parse(value)
end
<span class="comments">;=============================================================================</span>
</code>
    </div>
  </body>
</html>