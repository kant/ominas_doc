<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.6.1 on Thu Jul 20 11:03:18 2017 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>grim_user_include.pro (OMINAS Documentation)</title>

    
    <style type="text/css" media="all">
            /* setup page */
      body { font-family: Helvetica, sans-serif; font-size: 12pt; margin: 0; padding: 0; }
      div.content { padding: 1em; }
      p { line-height: 1.4; }
      td p { padding-bottom: 0.5em; }
      img { border: 0; }
      
      /* link styles */
      a { text-decoration: none; }
      a:link, a:visited { color: #0000FF; }
      a:hover, a:focus { background: yellow; border-bottom: 1emx dotted #303099; }
      
      /* dir-overview styles */
      dt.filename { margin-top: 0.5em; }
      dl.file_listing { margin-left: 1em; }
      
      /* titles */
      h1, h2, h3, h4 { font-weight:normal; color: #871E31; margin-top: 1.5em; }
      h4 { margin-bottom: 0.25em; }
      .center { margin-left: auto; margin-right: auto; }
      .small { font-family: Verdana, Helvetica, sans-serif; font-size: 90%; }
      .smaller { font-family: Verdana, Helvetica, sans-serif; font-size: 80%; }
      .smallest { font-family: Verdana, Helvetica, sans-serif; font-size: 70%; }
      h1.basename { margin-top: 0; margin-bottom: 0; }
      h1.basename span.file-attributes { font-size: 70%; margin-left: 3em; color: #384806; }
      h2.directory { font-size: 90%; margin-bottom: 0; }
      h2.routine-name { margin-top: 0; margin-bottom: 0; }
      p.categories { color: #384806; margin-top: 0; }
      span.file_attribute { float: right; color: #384806; margin: 0 0 1em 3em; }
      div#file_comments { margin-top: 1em; }
      
      div.routine-details { border: 1px dotted #C0C0C0; margin-top: 1em; padding: 1em; }
      span.routine-attributes { font-size: 70%; margin-left: 3em; color: #384806; }
      div.details dt { color: #871E31; margin-left: 2em; }
      div.details dt span { color: #384806; margin-left: 2em; }
      div.details dd { margin: 0.5em 2em 1em 4em; }
      a.top {
        font-family: Verdana, Helvetica, sans-serif;
        font-size: 8pt;
        font-weight: bold;
        color: #5070ff;
        text-transform: uppercase;
        float: right;
        margin-left: 1em;
      }
      
      /* comments */
      .pre { white-space: pre; }
      
      /* code styles */
      code { font-family: Monaco, "Courier New", Courier, monospace; font-size: 95%; }
      code.listing { white-space: pre; display: block; margin: 0.75em 0 0.75em 0; padding: 0 3em 0 1em; line-height: 1.4em; }
      code.source { white-space: pre; display: block; }
      code.source span.comments { color: #408080; }
      .syntax { margin-top: 1em; margin-left: 1.5em; text-indent: -1.5em; }
      .var { font-style: italic; }
      .argument { } /* white-space: nowrap; does not work in Safari (and sometimes not even in Firefox) */
      
      dl.routine-summary dt { margin-bottom: 0.25em; }
      dl.routine-summary dd { margin-bottom: 0.5em; margin-left: 2em; }
      
      ul.inherited-method-summary { padding-left: 0em; margin-left: 0em; }
      
      /* general styles */
      ul li { list-style-type: none; }
      table { empty-cells: show; }
      thead { color: #871E31; }
      dd { margin-bottom: 0.35em; }
      input, textarea { background: #F3F6ED; border: #E1D6C6 1px solid; padding: 2px 1em 2px 0.5em; }
      input.text { background: #FFFFC0; }
      
      div.note { margin: 1em 2em 1em 2em; background: #EFEFEF; border: 1px #A0A0A0 dotted; padding: 0 1em 0 1em; }
      p.indent { margin-left: 2em; }
      
      /* An attribute table is a vertical list of name-value pairs. */
      table.box {
        background: #EFEFEF;
        border: 1px #A0A0A0 dotted;
        padding-top: 0.75em;
        padding-bottom: 0.75em;
      }
      table.attribute { padding-left: 0.75em; padding-right: 0.75em; }
      table td { vertical-align: top; }
      table.attribute p { margin: 0; }
      table td.name { font-style: normal; padding-right: 1.5em; }
      ul.fieldslist { padding-top: 0; color: #909090; }
      ul.fieldslist li { margin-bottom: 0.25em; }
      span.fieldname { color: #000000; }
      
      dl.attribute dt { color: #990000; }
      
      /* header/navbar styles */
      div.header { padding: 2em 2em 0 2em; background: #9E9D7B; border-bottom: 2px #262626 solid; }
      div.header h1 { color: white; margin:0; font-weight: normal; }
      div.header h2 { color: white; margin-top: 0; margin-bottom: 1em; font-weight: normal; font-style: italic; font-size: 100%; }
      table.navbar { background: #CCC097; margin: 0; padding: 0; border-bottom: 1px #262626 dotted; width: 100%; }
      table.navbar td { padding: 4px 0.5em 3px 0.5em; white-space: nowrap; vertical-align: top; }
      table.navbar td.flexible { width: 100%; text-align: right; padding-right: 1em; white-space: nowrap; }
      table.navbar td.selected { background: #262626; }
      table.navbar td.selected, table.navbar td.selected a { color: white; }
      table.navbar a:hover, table.navbar a:focus { background: inherit; border-bottom: 1px solid #303099; }
      p.localnavbar { text-align: right; margin: 0.2em 1em 0.2em 0.2em; padding: 0; }
      
      /* CSS graphics styles */
      div.box {
        margin-left: 0.25em;
        display: inline-block;
        width: 0.9em;
        height: 0.9em;
        vertical-align: -1px;
      }
      .red { background-color: #A00; }
      .orange { background-color: #F40; }
      .green { background-color: #480; }
      
      /* index styles */
      span.index_type { margin-left: 1em; }
      dl.index_listing dd { margin-bottom: 0.5em; margin-left: 2em; }
      dl.index_listing dd p { margin-top: 0.2em; margin-bottom: 0em; }
      
      /* search styles */
      fieldset { border: #ddd 1px solid; padding: 1em; margin-top: 3em; }
      legend { color: #871E31; font-size: 120%; }
      label { white-space: nowrap; }
      p.description { margin: 2em 2em 1em 2em; }
      form table td.name { vertical-align: middle; }
      
      /* footer styles */
      div.footer { padding: 0.5em 1em 0.5em 1em; background: #EFEFEF; border-top: 1px #A0A0A0 dotted; }
      div.footer table { width: 100%; }
      div.footer td.right { text-align: right; }

    </style>
    <style type="text/css" media="print">
            p.localnavbar { display: none; }
      
      div.header { background: white; }
      div.header h1 { color: black; }
      div.header h2 { color: black; }

    </style>
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="grim_user_include.pro (OMINAS Documentation)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;=============================================================================</span>
<span class="comments">; grim_user_ptd_struct__define</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_user_ptd_struct__define:source"></a>pro grim_user_ptd_struct__define

 struct = $
    { grim_user_ptd_struct, $
	user_ptdp	:	ptr_new(), $
	color		:	'', $
	shade_fn	:	'', $
	psym		:	0, $
	thick		:	1, $
	line		:	1, $
	shade_threshold	:	0d, $
	graphics_fn	:	3, $
	xgraphics	:	0b, $
	symsize		:	0. $
    }


end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; grim_add_user_points</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_add_user_points:source"></a>pro grim_add_user_points, grnum=grnum, user_ptd, tag, update=update, $
                  color=color, shade_fn=shade_fn, psym=psym, thick=thick, line=line, symsize=symsize, $
                  shade_threshold=shade_threshold, graphics_fn=graphics_fn, xgraphics=xgraphics, nodraw=nodraw, inactive=inactive, $
                  no_refresh=no_refresh, plane=plane

 if(NOT keyword_set(tag)) then tag = 'no_name'
 if(NOT keyword_set(symsize)) then symsize = 1
 if(NOT keyword_set(shade_fn)) then shade_fn = ''
 if(NOT keyword_set(shade_threshold)) then shade_threshold = 0d

 if(NOT defined(grnum)) then if(keyword_set(plane)) then grnum = plane.grnum
 grim_data = grim_get_data(grnum=grnum)
 if(NOT keyword_set(plane)) then plane = grim_get_plane(grim_data)

 pn = plane.pn

 n = n_elements(user_ptd)
 for i=0, n-1 do if(pnt_valid(user_ptd[i])) then cor_set_name, user_ptd[i], tag

 if(NOT keyword_set(color)) then color = 'purple' 

 if(NOT keyword_set(graphics_fn)) then graphics_fn = grim_data.default_user_graphics_fn
 if(NOT keyword_set(xgraphics)) then xgraphics = 0
 if(NOT keyword_set(psym)) then psym = grim_data.default_user_psym
 if(NOT keyword_set(thick)) then thick = grim_data.default_user_thick
 if(NOT keyword_set(line)) then line = grim_data.default_user_line

 user_struct = {grim_user_ptd_struct}
 user_struct.user_ptdp = ptr_new(user_ptd)
 user_struct.color = color
 user_struct.shade_fn = shade_fn
 user_struct.psym = psym
 user_struct.shade_threshold = shade_threshold
 user_struct.graphics_fn = graphics_fn
 user_struct.xgraphics = xgraphics
 user_struct.thick = thick
 user_struct.line = line
 user_struct.symsize = symsize

 tlp = plane.user_ptd_tlp
 if(keyword_set(update)) then $
              if((tag_list_match(tlp, tag))[0] EQ -1) then return

 tag_list_set, tlp, tag, user_struct, new=new, index=index
 plane.user_ptd_tlp = tlp
 grim_set_plane, grim_data, plane, pn=pn

 if(NOT keyword_set(inactive)) then grim_activate_user_overlay, plane, index


 if(keyword_set(nodraw)) then return

 if(NOT keyword_set(no_refresh)) then grim_refresh, grim_data, /use_pixmap

end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; grim_user_notify</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_user_notify:source"></a>pro grim_user_notify, grim_data, plane=plane

 if(NOT keyword_set(plane.user_ptd_tlp)) then return
 if(NOT ptr_valid(plane.user_ptd_tlp)) then return

 names = tag_list_names(plane.user_ptd_tlp)
 n = n_elements(names)

 cd = *plane.cd_p

 nv_suspend_events

 for i=0, n-1 do $
  begin
   user_struct = tag_list_get(plane.user_ptd_tlp, names[i])
   ptd = *user_struct.user_ptdp
   nptd = n_elements(ptd)
   for j=0, nptd-1 do $
    begin
     v = pnt_vectors(ptd[j])
     if(keyword_set(v)) then $
                pnt_set_points, ptd[j], reform(inertial_to_image_pos(cd, v))
    end
  end

 nv_resume_events
end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; grim_update_user_points</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_update_user_points:source"></a>pro grim_update_user_points, plane=plane, grnum=grnum, user_ptd, tag, $
                  color=color, shade_fn=shade_fn, psym=psym, thick=thick, line=line, symsize=symsize, $
                  shade_threshold=shade_threshold, graphics_fn=graphics_fn, xgraphics=xgraphics, nodraw=nodraw, $
                  no_refresh=no_refresh

 if(NOT keyword_set(grnum)) then if(keyword_set(plane)) then grnum = plane.grnum
 grim_data = grim_get_data(grnum=grnum)
 if(NOT keyword_set(plane)) then plane = grim_get_plane(grim_data)

 if(NOT keyword_set(plane.user_ptd_tlp)) then return
 if(NOT ptr_valid(plane.user_ptd_tlp)) then return


 user_struct = tag_list_get(plane.user_ptd_tlp, tag)

 if(arg_present(color)) then user_struct.color = color
 if(arg_present(shade_fn)) then user_struct.shade_fn = shade_fn
 if(arg_present(psym)) then user_struct.psym = psym
 if(arg_present(shade_threshold)) then user_struct.shade_threshold = shade_threshold
 if(arg_present(graphics_fn)) then user_struct.graphics_fn = graphics_fn
 if(arg_present(xgraphics)) then user_struct.xgraphics = xgraphics
 if(arg_present(thick)) then user_struct.thick = thick
 if(arg_present(line)) then user_struct.line = line
 if(arg_present(symsize)) then user_struct.symsize = symsize

 tlp = plane.user_ptd_tlp
 tag_list_set, tlp, tag, user_struct, new=new, index=index
 plane.user_ptd_tlp = tlp
 grim_set_plane, grim_data, plane, pn=pn


 if(keyword_set(nodraw)) then return
 if(NOT keyword_set(no_refresh)) then grim_refresh, grim_data, /use_pixmap

end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; grim_rm_user_points</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_rm_user_points:source"></a>pro grim_rm_user_points, grim_data, tag, plane=plane, grnum=grnum

 if(NOT keyword_set(plane)) then $
  begin
   grim_data = grim_get_data(grnum=grnum)
   plane = grim_get_plane(grim_data)
  end

 if(NOT keyword_set(plane.user_ptd_tlp)) then return
 if(NOT ptr_valid(plane.user_ptd_tlp)) then return

 for i=0, n_elements(tag)-1 do tag_list_rm, plane.user_ptd_tlp, tag[i]


end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; grim_test_active_user_ptd</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_test_active_user_ptd:source"></a>function grim_test_active_user_ptd, plane, tag, prefix=prefix

 if(NOT keyword_set(*plane.active_user_tags_p)) then return, 0

 w = tag_list_match(*plane.active_user_tags_p, tag, prefix=prefix)
 if(w[0] NE -1) then return, 1

 return, 0
end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; grim_get_user_ptd</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_get_user_ptd:source"></a>function grim_get_user_ptd, grnum=grnum, tag, prefix=prefix, $
           plane=plane, color=color, shade_fn=shade_fn, $
           xgraphics=xgraphics, graphics_fn=graphics_fn, $
           shade_threshold=shade_threshold, psym=psym, thick=thick, $
           line=line, symsize=symsize, $
           tags=tags, active=active

<span class="comments">; if(NOT keyword_set(tag)) then tag = 'no_name'</span>

 if(NOT keyword_set(plane)) then $
  begin
   grim_data = grim_get_data(grnum=grnum)
   plane = grim_get_plane(grim_data)
  end

 if(NOT keyword_set(plane.user_ptd_tlp)) then return, 0
 if(NOT ptr_valid(plane.user_ptd_tlp)) then return, 0

 if(NOT keyword_set(tag)) then tag = (*plane.user_ptd_tlp).name

 n = n_elements(tag)

 user_ptd = 0
 for i=0, n-1 do $
  begin
   user_struct = tag_list_get(plane.user_ptd_tlp, tag[i], prefix=prefix)

   nu = n_elements(user_struct)
   if(keyword_set(user_struct)) then $
    if((NOT keyword_set(active)) OR $
        grim_test_active_user_ptd(plane, tag[i], prefix=prefix)) then $
     begin
      if(NOT keyword_set(user_ptd)) then $
       begin
        for j=0, nu-1 do $
            if(keyword_set(*user_struct[j].user_ptdp)) then $
                    user_ptd = append_array(user_ptd, *user_struct[j].user_ptdp)
        color = user_struct.color
        shade_fn = user_struct.shade_fn
        psym = user_struct.psym
        shade_threshold = user_struct.shade_threshold
        graphics_fn = user_struct.graphics_fn
        xgraphics = user_struct.xgraphics
        thick = user_struct.thick
        line = user_struct.line
        symsize = user_struct.symsize
        tags = tag[i]
       end $
      else $
       begin
        _user_ptd = objarr(nu)
<span class="comments">;        for j=0, nu-1 do _user_ptd[j] = *user_struct[j].user_ptdp</span>
        for j=0, nu-1 do _user_ptd[j] = (*user_struct[j].user_ptdp)[0]
        user_ptd = [user_ptd, _user_ptd]
        color = [color, user_struct.color]
        shade_fn = [shade_fn, user_struct.shade_fn]
        psym = [psym, user_struct.psym]
        shade_threshold = [shade_threshold, user_struct.shade_threshold]
        graphics_fn = [graphics_fn, user_struct.graphics_fn]
        xgraphics = [xgraphics, user_struct.xgraphics]
        thick = [thick, user_struct.thick]
        line = [line, user_struct.line]
        symsize = [symsize, user_struct.symsize]
        tags = [tags, tag[i]]
       end
     end
  end

 return, user_ptd
end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; grim_get_active_user_overlays</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_get_active_user_overlays:source"></a>pro grim_get_active_user_overlays, plane, $
                         active_tags=active_tags, inactive_tags=inactive_tags

 if(NOT ptr_valid(plane.user_ptd_tlp)) then return

 tags = (*plane.user_ptd_tlp).name
 nuser = n_elements(tags)

 active_indices = -1
 inactive_indices = lindgen(nuser)
 inactive_tags = tags[inactive_indices]
 

 if(NOT keyword__set(*plane.active_user_tags_p)) then return
 active_user_tags = *plane.active_user_tags_p

 w = nwhere(tags, active_user_tags)
 if(w[0] EQ -1) then return

 active_indices = w
 inactive_indices = complement(tags, active_indices)

 inactive_tags = ''
 if(active_indices[0] NE -1) then active_tags = tags[active_indices]
 if(inactive_indices[0] NE -1) then inactive_tags = tags[inactive_indices]

end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; grim_trim_user_overlays</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_trim_user_overlays:source"></a>pro grim_trim_user_overlays, grim_data, plane=plane, region

 if(NOT keyword_set(plane)) then plane = grim_get_plane(grim_data)

 ptd = grim_get_user_ptd(plane=plane)
 if(keyword_set(ptd)) then pg_trim, 0, ptd, region

end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; grim_activate_user_overlay</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_activate_user_overlay:source"></a>pro grim_activate_user_overlay, plane, indices

 if(indices[0] EQ -1) then return
 if(NOT ptr_valid(plane.user_ptd_tlp)) then return

 tags = (*plane.user_ptd_tlp).name
 active_user_tags = *plane.active_user_tags_p
 given_user_tags = tags[indices]

 <span class="comments">;---------------------------------------------</span>
 <span class="comments">; determine which user_ptd are already active</span>
 <span class="comments">;---------------------------------------------</span>
 n = n_elements(given_user_tags)
 w = [-1]
 ww = lindgen(n)

 if(keyword__set(active_user_tags)) then $
  begin
   w = nwhere(given_user_tags, active_user_tags)
   ww = complement(indices, w)
  end

 <span class="comments">;---------------------------------------------</span>
 <span class="comments">; activate inactive user_ptd</span>
 <span class="comments">;---------------------------------------------</span>
 if(ww[0] NE -1) then $
  begin
   if(NOT keyword__set(active_user_tags)) then $
                              *plane.active_user_tags_p = given_user_tags[ww] $
   else *plane.active_user_tags_p = [active_user_tags, given_user_tags[ww]]
  end


end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; grim_deactivate_user_overlay</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_deactivate_user_overlay:source"></a>pro grim_deactivate_user_overlay, plane, indices

 if(indices[0] EQ -1) then return
 if(NOT ptr_valid(plane.user_ptd_tlp)) then return

 tags = (*plane.user_ptd_tlp).name
 active_user_tags = *plane.active_user_tags_p
 if(NOT keyword__set(active_user_tags)) then return
 given_user_tags = tags[indices]

 <span class="comments">;---------------------------------------------</span>
 <span class="comments">; determine which user_ptd are already active</span>
 <span class="comments">;---------------------------------------------</span>
 n = n_elements(given_user_tags)
 w = [-1]
 ww = lindgen(n)

 w = nwhere(active_user_tags, given_user_tags)
 ww = complement(indices, w)

 <span class="comments">;---------------------------------------------</span>
 <span class="comments">; activate inactive user_ptd</span>
 <span class="comments">;---------------------------------------------</span>
 if(w[0] NE -1) then $
  begin
    *plane.active_user_tags_p = $
                  rm_list_item(*plane.active_user_tags_p, w, only='')
    if(NOT keyword__set((*plane.active_user_tags_p)[0])) then $
                                                *plane.active_user_tags_p = ''
  end


end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; grim_clear_user_overlays</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_clear_user_overlays:source"></a>pro grim_clear_user_overlays, plane, tags

 <span class="comments">;------------------------------------------</span>
 <span class="comments">; get tags of active user overlays</span>
 <span class="comments">;------------------------------------------</span>
<span class="comments">; grim_get_active_user_overlays, plane, active_tags=active_tags</span>
<span class="comments">; if(NOT keyword__set(active_tags)) then return</span>

 <span class="comments">;------------------------------------------</span>
 <span class="comments">; remove active user overlays</span>
 <span class="comments">;------------------------------------------</span>
 n = n_elements(tags)
 for i=0, n-1 do tag_list_rm, plane.user_ptd_tlp, tags[i]

<span class="comments">; if(NOT keyword__set((*plane.user_ptd_tlp)[0])) then ptr_free, plane.user_ptd_tlp</span>

 <span class="comments">;------------------------------------------</span>
 <span class="comments">; clear active user overlay array</span>
 <span class="comments">;------------------------------------------</span>
<span class="comments">; *plane.active_user_tags_p = ''</span>


end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; grim_clear_active_user_overlays</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_clear_active_user_overlays:source"></a>pro grim_clear_active_user_overlays, plane

 <span class="comments">;------------------------------------------</span>
 <span class="comments">; get tags of active user overlays</span>
 <span class="comments">;------------------------------------------</span>
 grim_get_active_user_overlays, plane, active_tags=active_tags
 if(NOT keyword__set(active_tags)) then return

 <span class="comments">;------------------------------------------</span>
 <span class="comments">; remove active user overlays</span>
 <span class="comments">;------------------------------------------</span>
 n = n_elements(active_tags)
 for i=0, n-1 do tag_list_rm, plane.user_ptd_tlp, active_tags[i]

<span class="comments">; if(NOT keyword__set((*plane.user_ptd_tlp)[0])) then ptr_free, plane.user_ptd_tlp</span>

 <span class="comments">;------------------------------------------</span>
 <span class="comments">; clear active user overlay array</span>
 <span class="comments">;------------------------------------------</span>
 *plane.active_user_tags_p = ''


end
<span class="comments">;=============================================================================</span>



<span class="comments">;=============================================================================</span>
<span class="comments">; grim_invert_active_user_overlays</span>
<span class="comments">;</span>
<span class="comments">;=============================================================================</span>
<a id="grim_invert_active_user_overlays:source"></a>pro grim_invert_active_user_overlays, plane

 if(NOT ptr_valid(plane.user_ptd_tlp)) then return

 <span class="comments">;---------------------------------------------------------</span>
 <span class="comments">; determine which ptdp are currently active/inactive</span>
 <span class="comments">;---------------------------------------------------------</span>

 tags = (*plane.user_ptd_tlp).name
 active_user_tags = *plane.active_user_tags_p

 nptd = n_elements(tags)

 w = [-1]
 ww = lindgen(nptd)

 if(keyword__set(active_user_tags)) then $
  begin
   w = nwhere(tags, active_user_tags)		<span class="comments">; active</span>
   ww = complement(tags, w)			<span class="comments">; inactive</span>
  end

 <span class="comments">;---------------------------------------------</span>
 <span class="comments">; deactivate active objects</span>
 <span class="comments">;---------------------------------------------</span>
 if(w[0] NE -1) then grim_deactivate_user_overlay, plane, w

 <span class="comments">;---------------------------------------------</span>
 <span class="comments">; activate previously inactive objects</span>
 <span class="comments">;---------------------------------------------</span>
 if(ww[0] NE -1) then grim_activate_user_overlay, plane, ww

 
end
<span class="comments">;=============================================================================</span>

<a id="grim_user_include:source"></a>pro grim_user_include
a=!null
end

</code>
    </div>
  </body>
</html>