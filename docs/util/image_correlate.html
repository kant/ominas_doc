<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.6.1 on Tue Jul 18 14:20:54 2017 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>image_correlate.pro (OMINAS Documentation)</title>

    

    <script type="text/javascript" src="../idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="../idldoc-resources/js/copybutton.js"></script>

    
    <style type="text/css" media="all">
            /* setup page */
      body { font-family: Helvetica, sans-serif; font-size: 12pt; margin: 0; padding: 0; }
      div.content { padding: 1em; }
      p { line-height: 1.4; }
      td p { padding-bottom: 0.5em; }
      img { border: 0; }
      
      /* link styles */
      a { text-decoration: none; }
      a:link, a:visited { color: #0000FF; }
      a:hover, a:focus { background: yellow; border-bottom: 1emx dotted #303099; }
      
      /* dir-overview styles */
      dt.filename { margin-top: 0.5em; }
      dl.file_listing { margin-left: 1em; }
      
      /* titles */
      h1, h2, h3, h4 { font-weight:normal; color: #871E31; margin-top: 1.5em; }
      h4 { margin-bottom: 0.25em; }
      .center { margin-left: auto; margin-right: auto; }
      .small { font-family: Verdana, Helvetica, sans-serif; font-size: 90%; }
      .smaller { font-family: Verdana, Helvetica, sans-serif; font-size: 80%; }
      .smallest { font-family: Verdana, Helvetica, sans-serif; font-size: 70%; }
      h1.basename { margin-top: 0; margin-bottom: 0; }
      h1.basename span.file-attributes { font-size: 70%; margin-left: 3em; color: #384806; }
      h2.directory { font-size: 90%; margin-bottom: 0; }
      h2.routine-name { margin-top: 0; margin-bottom: 0; }
      p.categories { color: #384806; margin-top: 0; }
      span.file_attribute { float: right; color: #384806; margin: 0 0 1em 3em; }
      div#file_comments { margin-top: 1em; }
      
      div.routine-details { border: 1px dotted #C0C0C0; margin-top: 1em; padding: 1em; }
      span.routine-attributes { font-size: 70%; margin-left: 3em; color: #384806; }
      div.details dt { color: #871E31; margin-left: 2em; }
      div.details dt span { color: #384806; margin-left: 2em; }
      div.details dd { margin: 0.5em 2em 1em 4em; }
      a.top {
        font-family: Verdana, Helvetica, sans-serif;
        font-size: 8pt;
        font-weight: bold;
        color: #5070ff;
        text-transform: uppercase;
        float: right;
        margin-left: 1em;
      }
      
      /* comments */
      .pre { white-space: pre; }
      
      /* code styles */
      code { font-family: Monaco, "Courier New", Courier, monospace; font-size: 95%; }
      code.listing { white-space: pre; display: block; margin: 0.75em 0 0.75em 0; padding: 0 3em 0 1em; line-height: 1.4em; }
      code.source { white-space: pre; display: block; }
      code.source span.comments { color: #408080; }
      .syntax { margin-top: 1em; margin-left: 1.5em; text-indent: -1.5em; }
      .var { font-style: italic; }
      .argument { } /* white-space: nowrap; does not work in Safari (and sometimes not even in Firefox) */
      
      dl.routine-summary dt { margin-bottom: 0.25em; }
      dl.routine-summary dd { margin-bottom: 0.5em; margin-left: 2em; }
      
      ul.inherited-method-summary { padding-left: 0em; margin-left: 0em; }
      
      /* general styles */
      ul li { list-style-type: none; }
      table { empty-cells: show; }
      thead { color: #871E31; }
      dd { margin-bottom: 0.35em; }
      input, textarea { background: #F3F6ED; border: #E1D6C6 1px solid; padding: 2px 1em 2px 0.5em; }
      input.text { background: #FFFFC0; }
      
      div.note { margin: 1em 2em 1em 2em; background: #EFEFEF; border: 1px #A0A0A0 dotted; padding: 0 1em 0 1em; }
      p.indent { margin-left: 2em; }
      
      /* An attribute table is a vertical list of name-value pairs. */
      table.box {
        background: #EFEFEF;
        border: 1px #A0A0A0 dotted;
        padding-top: 0.75em;
        padding-bottom: 0.75em;
      }
      table.attribute { padding-left: 0.75em; padding-right: 0.75em; }
      table td { vertical-align: top; }
      table.attribute p { margin: 0; }
      table td.name { font-style: normal; padding-right: 1.5em; }
      ul.fieldslist { padding-top: 0; color: #909090; }
      ul.fieldslist li { margin-bottom: 0.25em; }
      span.fieldname { color: #000000; }
      
      dl.attribute dt { color: #990000; }
      
      /* header/navbar styles */
      div.header { padding: 2em 2em 0 2em; background: #9E9D7B; border-bottom: 2px #262626 solid; }
      div.header h1 { color: white; margin:0; font-weight: normal; }
      div.header h2 { color: white; margin-top: 0; margin-bottom: 1em; font-weight: normal; font-style: italic; font-size: 100%; }
      table.navbar { background: #CCC097; margin: 0; padding: 0; border-bottom: 1px #262626 dotted; width: 100%; }
      table.navbar td { padding: 4px 0.5em 3px 0.5em; white-space: nowrap; vertical-align: top; }
      table.navbar td.flexible { width: 100%; text-align: right; padding-right: 1em; white-space: nowrap; }
      table.navbar td.selected { background: #262626; }
      table.navbar td.selected, table.navbar td.selected a { color: white; }
      table.navbar a:hover, table.navbar a:focus { background: inherit; border-bottom: 1px solid #303099; }
      p.localnavbar { text-align: right; margin: 0.2em 1em 0.2em 0.2em; padding: 0; }
      
      /* CSS graphics styles */
      div.box {
        margin-left: 0.25em;
        display: inline-block;
        width: 0.9em;
        height: 0.9em;
        vertical-align: -1px;
      }
      .red { background-color: #A00; }
      .orange { background-color: #F40; }
      .green { background-color: #480; }
      
      /* index styles */
      span.index_type { margin-left: 1em; }
      dl.index_listing dd { margin-bottom: 0.5em; margin-left: 2em; }
      dl.index_listing dd p { margin-top: 0.2em; margin-bottom: 0em; }
      
      /* search styles */
      fieldset { border: #ddd 1px solid; padding: 1em; margin-top: 3em; }
      legend { color: #871E31; font-size: 120%; }
      label { white-space: nowrap; }
      p.description { margin: 2em 2em 1em 2em; }
      form table td.name { vertical-align: middle; }
      
      /* footer styles */
      div.footer { padding: 0.5em 1em 0.5em 1em; background: #EFEFEF; border-top: 1px #A0A0A0 dotted; }
      div.footer table { width: 100%; }
      div.footer td.right { text-align: right; }

    </style>
    <style type="text/css" media="print">
            p.localnavbar { display: none; }
      
      div.header { background: white; }
      div.header h1 { color: black; }
      div.header h2 { color: black; }

    </style>
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="image_correlate.pro (OMINAS Documentation)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>OMINAS Documentation</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
    
      <td>
        <a href="https://ppenteado.github.io/ominas_doc/user_guide/overview.html">User Guide</a>
      </td>
      <td>
        <a href="https://ppenteado.github.io/ominas_doc/nv/">API</a>
      </td>
      <td>
        <a href="https://ppenteado.github.io/ominas_doc/demo/">Demos</a>
      </td>
      <td>
        <a href="https://ppenteado.github.io/ominas_doc/demo/install_guide.html">Installation Guide</a>
      </td>
      <td class='flexible'>
      </td>
    
      </tr>
    </table>

    <div class="content">
      <h2 class="directory">util/</h2>
      <h1 class="basename">image_correlate.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      
      <div id="file_comments">
        <div class="small "><p> image_correlate

 PURPOSE :

  Search for the vector offset, t, at which image2 best correlates with
 image1 (without searching the entire array).


  The algorithm works as follows:

 1) begin with a grid of size nsamples covering the entire image1,
    for example, for nsample=[4,4], the grid might look like :

            -------------------------
           |   .     .     .     .   |
           |                         |<-----image array
           |                         |
           |   .     .     .     .   |
           |                         |
           |                         |
           |   .     .     .     .<--|---sample each of these offsets
           |                         |
           |                         |
           |   .     .     .     .   |
            -------------------------

 2) evaluate the cross correlation function of image1 and image2
     at each point on the grid and determine which point gave the
     best result.  Store this point and its correlation in
     best_arr.

 3) center a new grid of the same configuration at that point
     but make it smaller by grid_ratio :

            -------------------------
        ---|---.   .   .   .     .   |
         | |                         |<-----image array
    new  | |   .   .   .   .         |
    grid | |         +<----------.---|----best point from last scan
         | |   .   .   .   .         |
         | |                         |
        ---|---.   .   .   .     .   |
           |                         |
           |                         |
           |   .     .     .     .   |
            -------------------------

 4) continue until the entire grid becomes smaller than 1 pixel across.

 5) return the point in best_arr which gave the best correlation.

 Accuracy:
  The offset vector returned by this routine should usually
   lie within one pixel of the actual maximum correlation.  The
   result can only be guaranteed, though, if nsamples is set to the
   size of the array, but this is almost never practical.

 Speed:
  If you use nsamples of [2,2], the default, then each search cycle
   will be as fast as possible, but it will take many cycles to converge
   on the maximum.  If you use a very fine grid, then it may take only
   a few cycles, but the cycles will take very long.  Of course,
   generally one would expect it to be much faster to use a coarse grid
   as opposed to one of the same size as the array, otherwise, there
   would have been no reason to write this program.  The total time
   should scale as:

         t = nsamples(0)*nsamples(1)  *  ncycles

   where ncycles is the number of search cycles necessary to converge.
   The exact value depends on the two images and their initial
   offsets.


 NOTE: Unless /nohome is set, the first point in best_arr always corresponds
       to t=[0,0], i.e; no shift at all.  Thus, if the
       images never needed to be shifted, then the result
       the result will always be zero offset.



 CALLING SEQUENCE :

   t=image_correlate(im1, im2, correlation)


 ARGUMENTS
  INPUT : im1 - reference image

          im2 - image to be shifted

  OUTPUT : correlation - cross correlation value after im2 has been
                         shifted by t.



 KEYWORDS
  INPUT : show - Show the search.

          nsamples - 2D vector giving the dimensions of the search grid,
                     default is [2,2].

          nohome - Do not check the offset [0,0] for best correlation.

          function_min, function_max - Name of a function to either
                                       minimize or maximize.  The
                                       function should be declared as
                                       follows:

                                         function [name], f, g, t

                                       and should return a number which
                                       indicates the degree of correlation
                                       between f ang g, with g shifted by t.

          indices - This keyword will only work properly if both images
                    are of the same dimensions.  It allows the caller
                    to specify a region over which the correlation
                    will be optomized by giving an array of the 1D subscripts
                    which lie within that region.

          kill_char - Key which can be used to abort the search and return
                      an offset of [0,0], with the corresponding correlation.
                      This slows down the loop a bit, but not significantly
                      for large images, in which it may be more important
                      for the user to be able to abort.

	   region - Size of region to scan, centered at offset [0,0].  If not
		    specified, the entire image is scanned.

  OUTPUT : NONE



 RETURN : t, the vector offset by which im2 had to be shifted for
          maximum correlation with im1.




 KNOWN BUGS : see 'Accuracy' above.



 ORIGINAL AUTHOR : J. Spitale ; 8/94

 UPDATE HISTORY : Spitale, 4/2002 -- added 'region' keyword

</p>

</div>
      </div>
      

      

      

      

      

      
      <div>
        <h2>Routines</h2>
        

      

      

      
      </div>
      

      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="image_correlate">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="image_correlate-code.html#image_correlate:source" class="top">source</a> image_correlate<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code><span class="var">result</span> = image_correlate(<span class="argument"><a href="#image_correlate:p:im1">im1</a></span><span class="argument">, <a href="#image_correlate:p:im2">im2</a></span><span class="argument">, <a href="#image_correlate:p:correlation">correlation</a></span><span class="argument">, <a href="#image_correlate:k:show">show</a>=<span class="var">show</span></span><span class="argument">, <a href="#image_correlate:k:nsamples">nsamples</a>=<span class="var">nsamples</span></span><span class="argument">, <a href="#image_correlate:k:nohome">nohome</a>=<span class="var">nohome</span></span><span class="argument">, <a href="#image_correlate:k:function_min">function_min</a>=<span class="var">function_min</span></span><span class="argument">, <a href="#image_correlate:k:function_max">function_max</a>=<span class="var">function_max</span></span><span class="argument">, <a href="#image_correlate:k:corners">corners</a>=<span class="var">corners</span></span><span class="argument">, <a href="#image_correlate:k:kill_char">kill_char</a>=<span class="var">kill_char</span></span><span class="argument">, <a href="#image_correlate:k:region">region</a>=<span class="var">region</span></span><span class="argument">, <a href="#image_correlate:k:data">data</a>=<span class="var">data</span></span><span class="argument">, <a href="#image_correlate:k:wx">wx</a>=<span class="var">wx</span></span><span class="argument">, <a href="#image_correlate:k:wy">wy</a>=<span class="var">wy</span></span><span class="argument">, <a href="#image_correlate:k:no_width">no_width</a>=<span class="var">no_width</span></span><span class="argument">, <a href="#image_correlate:k:bias">bias</a>=<span class="var">bias</span></span><span class="argument">, <a href="#image_correlate:k:nosearch">nosearch</a>=<span class="var">nosearch</span></span>)</code></p>

          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="image_correlate:p:im1">im1 <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:p:im2">im2 <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:p:correlation">correlation <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="image_correlate:k:show">show <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:k:nsamples">nsamples <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:k:nohome">nohome <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:k:function_min">function_min <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:k:function_max">function_max <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:k:corners">corners <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:k:kill_char">kill_char <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:k:region">region <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:k:data">data <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:k:wx">wx <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:k:wy">wy <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:k:no_width">no_width <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:k:bias">bias <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="image_correlate:k:nosearch">nosearch <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          

          

          

          
          <h3>Statistics</h3>

            <table class="attribute small" summary="Routine statistics">
              <tr>
                <td class="name">Lines:</td>
                <td><div class="box green"></div> 40 lines</td>
              </tr>

              <tr>
                <td class="name">Cyclomatic complexity:</td>
                <td><div class="box green"></div> 4</td>
                <tr>
                  <td class="name">Modified cyclomatic complexity:</td>
                  <td><div class="box green"></div> 4</td>
              </tr>
            </table>
          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Thu Jun 22 14:13:10 2017</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>40</td>
          </tr>

          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.6.1 on Tue Jul 18 14:20:54 2017</td>
          <td class="right"><a target="_top" href="http://github.com/mgalloy/idldoc">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>